package DeroulementJeu;

import java.util.Random;

import GestionFichier.Pieces;
import InterfaceGraphique.Fenetre;
import InterfaceGraphique.RenderBoard;

// Cest la fonction qui va gérer le tableau

public class Deroulement {
	
	public static int[][] Board;
	private Fenetre fenetre;
	private Pieces piece_tetris;
	private int choose_random_piece;
	private int[][] piece;

		// Fonction qui sert à initialiser le jeu
		public void initialise() {
			System.out.println("initialisation du jeu...");
			
			// Crée le plateau de jeu
			Board= new int[Fenetre.NUM_LIGNE_TETRIS][Fenetre.NUM_COL_TETRIS];
			
			// Permet d'initialiser l'interface graphique
			fenetre= new Fenetre();
			fenetre.creationfenetre();	
			
			// Charge une premiere piece
			piece_tetris= new Pieces();
			
			// On choisit un nombre aléatoire parmi les pieces existantes afin de choisir la piece a crée
			int choose_random_piece = randomInt(1 ,Pieces.NOMBRE_PIECE);
			piece=piece_tetris.get_piece(choose_random_piece);
			Board=loadpiece(piece);
						
			/*for (int i=0; i < Fenetre.NUM_LIGNE_TETRIS; i++) {
				System.out.println("");
				for (int j=0; j < Fenetre.NUM_COL_TETRIS; j++) {
					
					System.out.print(Board[i][j]);
					
					
				}
			}*/
			
		}  
		
		// Fonction qui sera réactualisé au cours du temps
		public void run() {
			// Attente de 1 s avant de refresh
			try {
				Thread.sleep(1000);
			} catch (InterruptedException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			} 
			
			
			descendrepiece();
			
		}
		
		public static void descendrepiece() {
			
			int [][] temp = new int [Fenetre.NUM_LIGNE_TETRIS][Fenetre.NUM_COL_TETRIS];
			
			for (int i=0; i < Fenetre.NUM_LIGNE_TETRIS; i++) {
				for (int j=0; j < Fenetre.NUM_COL_TETRIS; j++) {
					if (i>0) {
					temp[i][j]=Board[i-1][j];
					}
					
				}
			}
			Board=temp;
			/*
		  	Board[1][3]=5;
		  	Board[1][4]=5;
		  	Board[1][5]=5;
		  	Board[1][6]=5;
		  	Board[2][3]=0;
		  	Board[2][4]=0;
		  	Board[2][5]=5;
		  	Board[2][6]=5;
		  	Board[3][3]=5;
		  	Board[3][4]=5;
		  	Board[3][5]=5;
		  	Board[3][6]=5;
		  	Board[4][3]=5;
		  	Board[4][4]=5;
		  	Board[4][5]=5;
		  	Board[4][6]=5;*/

		}
		
		// Fonction qui permet de retourner un nombre aléatoire entre 0 et Nombre de piece
		public static int randomInt (int minimum, int maximum) {
			Random random= new Random();
			int randomInteger= random.nextInt((maximum-minimum)+1)+minimum;
			
			return randomInteger;
		}
		
		public static int [][] getBoard() {
			return Board;
		}
		
		public static int[][] loadpiece(int[][] newpiece) {
			
			
				
				for (int i=0; i < 4; i++) {
					for (int j=3; j < 7; j++) {
						for (int piecevalue=0; piecevalue < 16; piecevalue++) {
						Board[i][j]=newpiece[0][piecevalue];
						System.out.print(Board[i][j]);
						}
					}
				
			}
			return Board;
		}
		
}
